/* @preserve
 *
 * angular-slidezilla
 * https://github.com/itslenny/angular-slidezilla
 *
 * Version: 0.1.3 - 02/21/2015
 * License: MIT
 */
"use strict";angular.module("angular-slidezilla",[]).constant("angularSlidezillaConfig",{min:0,max:100,step:5}).controller("AngularSlidezillaController",["angularSlidezillaConfig","$scope",function(angularSlidezillaConfig,$scope){$scope.min=angularSlidezillaConfig.min||0;$scope.max=angularSlidezillaConfig.max||100;$scope.step=angularSlidezillaConfig.step||5}]).directive("slider",function(){return{scope:{model:"=ngModel"},restrict:"E",require:["ngModel"],controller:"AngularSlidezillaController",link:function(scope,element,attrs,ctrls){if(attrs.min){scope.min=scope.$parent.$eval(attrs.min);scope.$parent.$watch(attrs.min,function(newVal){scope.min=newVal;ctrls[0].$render()})}if(attrs.max){scope.max=scope.$parent.$eval(attrs.max);scope.$parent.$watch(attrs.max,function(newVal){scope.max=newVal;ctrls[0].$render()})}if(attrs.step){scope.step=scope.$parent.$eval(attrs.step);scope.$parent.$watch(attrs.step,function(newVal){scope.step=newVal;ctrls[0].$render()})}var handles=element[0].querySelectorAll(".slider-handle");var track=element[0].querySelector(".slider-track");var selection=element[0].querySelector(".slider-selection");var dragging=false;ctrls[0].$render=function(){var hPos1,hPos2;clampModelValue();ctrls[0].$setViewValue(scope.model);if(typeof scope.model=="number"){hPos1=0;hPos2=100/(scope.max-scope.min)*(scope.model-scope.max)+100;angular.element(handles[0]).css("margin-left",hPos2+"%");angular.element(handles[1]).addClass("hidden")}else{hPos1=100/(scope.max-scope.min)*(scope.model[0]-scope.max)+100;hPos2=100/(scope.max-scope.min)*(scope.model[1]-scope.max)+100;angular.element(handles[0]).css("margin-left",hPos1+"%");angular.element(handles[1]).css("margin-left",hPos2+"%").removeClass("hidden")}angular.element(selection).css("margin-left",hPos1+"%").css("width",hPos2-hPos1+1+"%")};angular.element(track).bind("mousedown",function(e){e.preventDefault();if(dragging)return;var newVal=scope.model;var offsetX=e.offsetX||e.layerX;if(typeof newVal=="number"){if(offsetX>handles[0].offsetLeft){newVal+=scope.step}else{newVal-=scope.step}}else{if(e.target==track&&offsetX<handles[0].offsetLeft){newVal[0]-=scope.step}else if(e.target==track&&offsetX>handles[1].offsetLeft){newVal[1]+=scope.step}else{if(e.target==selection&&offsetX>e.target.offsetWidth/2){newVal[1]-=scope.step}else{newVal[0]+=scope.step}}}scope.$apply(function(){scope.model=newVal;ctrls[0].$render()})});angular.element(handles).bind("mousedown",function(e){e.preventDefault();dragging={sx:e.clientX-e.target.offsetLeft,sy:e.clientY-e.target.offsetTop,w:e.target.offsetWidth,h:e.target.offsetHeight,element:e.target,index:e.target==handles[0]?0:1,container:e.target.parentElement.getBoundingClientRect()};angular.element(document).bind("mousemove",mousemove);angular.element(document).bind("mouseup",mouseup)});function mousemove(e){if(!dragging)return;dragging.y=e.clientY-dragging.sy;dragging.x=e.clientX-dragging.sx;if(dragging.x<0){dragging.x=0}else if(dragging.x>dragging.container.right-dragging.container.left){dragging.x=dragging.container.right-dragging.container.left}var percentVal=Math.max(0,Math.min(100,parseInt(dragging.x/(dragging.container.right-dragging.container.left)*100)));var normalizedVal=percentVal/100*(scope.max-scope.min)+scope.min;normalizedVal=parseFloat(normalizedVal.toFixed(3));var rounded=roundToStep(normalizedVal,scope.step);scope.$apply(function(){var setMVal=scope.model;if(typeof setMVal=="number"){setMVal=rounded}else{setMVal[dragging.index]=rounded}scope.model=setMVal;ctrls[0].$render()})}function mouseup(e){angular.element(document).unbind("mousemove",mousemove);angular.element(document).unbind("mouseup",mouseup);dragging=false}function roundToStep(val,step){return val>=0?val+step/2-(val+step/2)%step:val-step/2-(val+step/2)%step}function clampModelValue(){if(typeof scope.model=="number"){if(scope.model>scope.max){scope.model=scope.max}else if(scope.model<scope.min){scope.model=scope.min}}else{var cv0,cv1;if(scope.model[0]>scope.model[1]){cv1=scope.model[0];cv0=scope.model[1];scope.model[0]=cv0;scope.model[1]=cv1}if(scope.model[0]>scope.max){cv0=scope.max}else if(scope.model[0]<scope.min){cv0=scope.min}if(scope.model[1]>scope.max){cv1=scope.max}else if(scope.model[1]<scope.min){cv1=scope.min}if(cv0||cv1){scope.model=[cv0||scope.model[0],cv1||scope.model[1]]}}}},template:'<div class="slider slider-horizontal"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle round"></div><div class="slider-handle round"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><input type="text" class="slider"></div></div>',replace:true}});
//# sourceMappingURL=angular-slidezilla.min.js.map