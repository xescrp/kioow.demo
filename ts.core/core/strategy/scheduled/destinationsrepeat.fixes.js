var detected = [
    {
        "label": "Acra",
        "count": 2,
        "slugs": [
            "accra-gh",
        ],
        "countrycode": [
            "GH"
        ]
    },
    {
        "label": "Alejandría",
        "count": 2,
        "slugs": [
            "alexandria-eg",
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "Ammán",
        "count": 2,
        "slugs": [
            "amman-jo",
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Aqaba",
        "count": 2,
        "slugs": [
            "aqaba-jo",
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Aswan",
        "count": 2,
        "slugs": [
            "aswan-eg",
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "Ayutthaya",
        "count": 2,
        "slugs": [
            "ayutthaya-historical-park-th",
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Ba Be ",
        "count": 2,
        "slugs": [
            "ba-be-national-park-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Bahía Kosi",
        "count": 2,
        "slugs": [
            "kosi-bay-rd-za"
        ],
        "countrycode": [
            "ZA"
        ]
    },
    {
        "label": "Bangkok",
        "count": 2,
        "slugs": [
            "bangkok-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Battambang",
        "count": 2,
        "slugs": [
            "battambang-kh",
        ],
        "countrycode": [
            "KH"
        ]
    },
    {
        "label": "Belén",
        "count": 2,
        "slugs": [
            "bethlehem",
        ],
        "countrycode": [
            "",
            "IL"
        ]
    },
    {
        "label": "Brașov",
        "count": 2,
        "slugs": [
            "brasov-ro"
        ],
        "countrycode": [
            "RO"
        ]
    },
    {
        "label": "Camino Inca",
        "count": 2,
        "slugs": [
            "camino-inca-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Cat Cat ",
        "count": 2,
        "slugs": [
            "cat-cat-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Chiang Dao",
        "count": 2,
        "slugs": [
            "chiang-dao-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Chiang Mai",
        "count": 2,
        "slugs": [
            "chiang-mai-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Chiang Rai",
        "count": 2,
        "slugs": [
            "chiang-rai-th",
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Colca",
        "count": 2,
        "slugs": [
            "colca-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Costa Amalfitana",
        "count": 2,
        "slugs": [
            "amalfi-it"
        ],
        "countrycode": [
            "IT"
        ]
    },
    {
        "label": "Dades",
        "count": 2,
        "slugs": [
            "oued-dades-ma",
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Damnoen Saduak",
        "count": 2,
        "slugs": [
            "damnoen-saduak-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Dushanbe",
        "count": 2,
        "slugs": [
            "dushanbe-tj"
        ],
        "countrycode": [
            "TJ"
        ]
    },
    {
        "label": "Echmiadzin",
        "count": 2,
        "slugs": [
            "echmiadzin-am",
        ],
        "countrycode": [
            "AM"
        ]
    },
    {
        "label": "El Cairo",
        "count": 2,
        "slugs": [
            "cairo-eg",
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "El Calafate",
        "count": 2,
        "slugs": [
            "calafate-ar"
        ],
        "countrycode": [
            "AR"
        ]
    },
    {
        "label": "Essaouira",
        "count": 2,
        "slugs": [
            "esauira-ma",
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Fez",
        "count": 4,
        "slugs": [
            "fez-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Florencia",
        "count": 2,
        "slugs": [
            "florence-it"
        ],
        "countrycode": [
            "IT"
        ]
    },
    {
        "label": "Gargantas del Todra",
        "count": 2,
        "slugs": [
            "todrha-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Ha Long",
        "count": 4,
        "slugs": [
            "ha-long-bay-vn",
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hanói",
        "count": 3,
        "slugs": [
            "hanoi-vn",
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hiroshima",
        "count": 2,
        "slugs": [
            "hiroshima-jp",
        ],
        "countrycode": [
            "JP"
        ]
    },
    {
        "label": "Ho Chi Minh",
        "count": 3,
        "slugs": [
            "ho-chi-minh-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hoa Lu",
        "count": 2,
        "slugs": [
            "hoa-lu-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hoi An",
        "count": 2,
        "slugs": [
            "hoi-an-vn",
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hue",
        "count": 3,
        "slugs": [
            "hue-vn",
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hunedoara",
        "count": 2,
        "slugs": [
            "hunedoara-ro"
        ],
        "countrycode": [
            "RO"
        ]
    },
    {
        "label": "Ifrane",
        "count": 2,
        "slugs": [
            "ifrane-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Inhambane",
        "count": 2,
        "slugs": [
            "inhambane-mz"
        ],
        "countrycode": [
            "MZ"
        ]
    },
    {
        "label": "Kerak",
        "count": 2,
        "slugs": [
            "karak-jo"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Lao Cai",
        "count": 3,
        "slugs": [
            "lao-cai-vn",
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Luang Prabang",
        "count": 2,
        "slugs": [
            "luang-prabang-la"
        ],
        "countrycode": [
            "LA"
        ]
    },
    {
        "label": "Luxor",
        "count": 2,
        "slugs": [
            "luxor-eg",
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "Machu Picchu",
        "count": 3,
        "slugs": [
            "machu-picchu-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Mae Hong Son",
        "count": 2,
        "slugs": [
            "mae-hong-son-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Mai Chau",
        "count": 2,
        "slugs": [
            "tt-mai-chau-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Malé",
        "count": 2,
        "slugs": [
            "male-mv"
        ],
        "countrycode": [
            "MV"
        ]
    },
    {
        "label": "Mandalay",
        "count": 2,
        "slugs": [
            "mandalay-mm",
        ],
        "countrycode": [
            "MM"
        ]
    },
    {
        "label": "Mar Muerto",
        "count": 2,
        "slugs": [
            "dead-sea-jo"
        ],
        "countrycode": [
            "",
            "JO"
        ]
    },
    {
        "label": "Marrakesh",
        "count": 4,
        "slugs": [
            "marrakech-ma",
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Mil Islas",
        "count": 2,
        "slugs": [
            "thousand-islands"
        ],
        "countrycode": [
            "US",
            ""
        ]
    },
    {
        "label": "Monasterio de Rila",
        "count": 2,
        "slugs": [
            "rila-monastery-bg"
        ],
        "countrycode": [
            "BG"
        ]
    },
    {
        "label": "Monte Nebo",
        "count": 2,
        "slugs": [
            "mount-nebo-jo",
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Monte Verde",
        "count": 2,
        "slugs": [
            "monteverde-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "My Son",
        "count": 2,
        "slugs": [
            "my-son-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Nha Trang",
        "count": 2,
        "slugs": [
            "nha-trang-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Noravank",
        "count": 3,
        "slugs": [
            "noravan-am",
        ],
        "countrycode": [
            "AM"
        ]
    },
    {
        "label": "Olimpia",
        "count": 2,
        "slugs": [
            "oplimpias-gr"
        ],
        "countrycode": [
            "GR"
        ]
    },
    {
        "label": "Orachha",
        "count": 2,
        "slugs": [
            "orachha-in",
        ],
        "countrycode": [
            "IN"
        ]
    },
    {
        "label": "Osaka",
        "count": 2,
        "slugs": [
            "osaka-jp",
        ],
        "countrycode": [
            "JP"
        ]
    },
    {
        "label": "Ouagadougou",
        "count": 2,
        "slugs": [
            "ouagadougou-bf"
        ],
        "countrycode": [
            "BF"
        ]
    },
    {
        "label": "Ouarzazate",
        "count": 3,
        "slugs": [
            "ouarzazate-ma",
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Parque Nacional Manuel Antonio",
        "count": 2,
        "slugs": [
            "parque-nacional-manuel-antonio-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional Ngorongoro",
        "count": 2,
        "slugs": [
            "ngorongoro-conservation-area-tz",
        ],
        "countrycode": [
            "TZ"
        ]
    },
    {
        "label": "Parque Nacional Rincon de la Vieja",
        "count": 3,
        "slugs": [
            "rincon-de-la-vieja-cr",
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional Tortuguero",
        "count": 2,
        "slugs": [
            "parque-nacional-tortuguero-cr",
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional Volcán Poás",
        "count": 2,
        "slugs": [
            "poas-volcano-cr",
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional de Jasper",
        "count": 2,
        "slugs": [
            "jasper-ca",
        ],
        "countrycode": [
            "CA"
        ]
    },
    {
        "label": "Parque Nacional de los Lagos de Plitvice",
        "count": 2,
        "slugs": [
            "plitvice-lakes-national-park-hr",
        ],
        "countrycode": [
            "HR"
        ]
    },
    {
        "label": "Petra",
        "count": 4,
        "slugs": [
            "wadi-musa"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Phnom Penh",
        "count": 2,
        "slugs": [
            "phnom-penh-kh"
        ],
        "countrycode": [
            "KH"
        ]
    },
    {
        "label": "Playa de Jaco",
        "count": 3,
        "slugs": [
            "playa-jaco-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Quebec",
        "count": 2,
        "slugs": [
            "quebec-ca",
        ],
        "countrycode": [
            "CA"
        ]
    },
    {
        "label": "Rabat",
        "count": 2,
        "slugs": [
            "rabat-ma",
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Rio de Janeiro",
        "count": 2,
        "slugs": [
            "rio-de-janeiro-br",
        ],
        "countrycode": [
            "BR"
        ]
    },
    {
        "label": "Roma",
        "count": 2,
        "slugs": [
            "rome-it"
        ],
        "countrycode": [
            "IT"
        ]
    },
    {
        "label": "Saint Louis",
        "count": 2,
        "slugs": [
            "saint-louis-sn",
        ],
        "countrycode": [
            "SN"
        ]
    },
    {
        "label": "Sapa",
        "count": 3,
        "slugs": [
            "sa-pa-vn",
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Sevan",
        "count": 3,
        "slugs": [
            "sevan-am",
        ],
        "countrycode": [
            "AM"
        ]
    },
    {
        "label": "Siem Reap",
        "count": 2,
        "slugs": [
            "siem-reap-kh"
        ],
        "countrycode": [
            "KH"
        ]
    },
    {
        "label": "Sighișoara",
        "count": 2,
        "slugs": [
            "sighisoara-ro"
        ],
        "countrycode": [
            "RO"
        ]
    },
    {
        "label": "Sukhothai",
        "count": 2,
        "slugs": [
            "sukhothai-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Tel Aviv",
        "count": 2,
        "slugs": [
            "tel-aviv-yafo-il"
        ],
        "countrycode": [
            "IL"
        ]
    },
    {
        "label": "Telouet",
        "count": 2,
        "slugs": [
            "telouet-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Tetúan",
        "count": 2,
        "slugs": [
            "tetuan-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Trakai",
        "count": 2,
        "slugs": [
            "trakai-lt"
        ],
        "countrycode": [
            "LT"
        ]
    },
    {
        "label": "Tuy Hoa",
        "count": 2,
        "slugs": [
            "tuy-hoa-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Tánger",
        "count": 2,
        "slugs": [
            "tanger-ma",
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Urubamba",
        "count": 2,
        "slugs": [
            "urubamba-pe",
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Vlorë",
        "count": 2,
        "slugs": [
            "vlora-al",
        ],
        "countrycode": [
            "AL"
        ]
    },
    {
        "label": "Volcán Arenal",
        "count": 4,
        "slugs": [
            "volcan-arenal-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Éfeso",
        "count": 2,
        "slugs": [
            "efes-harabeleri-tr",
            "efesou-gr"
        ],
        "countrycode": [
            "TR",
            "GR"
        ]
    }
];

var repeated = [
    {
        "label": "Acra",
        "count": 2,
        "slugs": [
            "accra-gh",
            "accra-metropolis-gh"
        ],
        "countrycode": [
            "GH"
        ]
    },
    {
        "label": "Alejandría",
        "count": 2,
        "slugs": [
            "alexandria-eg",
            "alexandria-governorate-eg"
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "Ammán",
        "count": 2,
        "slugs": [
            "amman-jo",
            "queen-alia-international-airport-jo"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Apollonia",
        "count": 2,
        "slugs": [
            "apollonia-gr",
            "rruga-apollonia-al"
        ],
        "countrycode": [
            "GR",
            "AL"
        ]
    },
    {
        "label": "Aqaba",
        "count": 2,
        "slugs": [
            "aqaba-jo",
            "king-hussein-international-airport-jo"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Aswan",
        "count": 2,
        "slugs": [
            "aswan-eg",
            "aswan-governorate-eg"
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "Ayutthaya",
        "count": 2,
        "slugs": [
            "ayutthaya-historical-park-th",
            "phra-nakhon-si-ayutthaya-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Ba Be ",
        "count": 2,
        "slugs": [
            "ba-be-district-vn",
            "ba-be-national-park-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Bahía Kosi",
        "count": 2,
        "slugs": [
            "kosi-bay-close-za",
            "kosi-bay-rd-za"
        ],
        "countrycode": [
            "ZA"
        ]
    },
    {
        "label": "Bangkok",
        "count": 2,
        "slugs": [
            "bangkok-noi-th",
            "bangkok-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Battambang",
        "count": 2,
        "slugs": [
            "battambang-kh",
            "krong-battambang-kh"
        ],
        "countrycode": [
            "KH"
        ]
    },
    {
        "label": "Belén",
        "count": 2,
        "slugs": [
            "bethlehem",
            "bethlehem-of-galilee-il"
        ],
        "countrycode": [
            "",
            "IL"
        ]
    },
    {
        "label": "Brașov",
        "count": 2,
        "slugs": [
            "brasov-ro",
            "poiana-brasov-ro"
        ],
        "countrycode": [
            "RO"
        ]
    },
    {
        "label": "Camino Inca",
        "count": 2,
        "slugs": [
            "camino-inca-pe",
            "inca-trail-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Cat Cat ",
        "count": 2,
        "slugs": [
            "cat-cat-village-vn",
            "cat-cat-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Cataratas del Niágara",
        "count": 2,
        "slugs": [
            "niagara-falls-ca",
            "niagara-falls-us"
        ],
        "countrycode": [
            "CA",
            "US"
        ]
    },
    {
        "label": "Chiang Dao",
        "count": 2,
        "slugs": [
            "chiang-dao-district-th",
            "chiang-dao-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Chiang Mai",
        "count": 2,
        "slugs": [
            "chiang-mai-international-airport-th",
            "chiang-mai-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Chiang Rai",
        "count": 2,
        "slugs": [
            "chiang-rai-th",
            "mueang-chiang-rai-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Colca",
        "count": 2,
        "slugs": [
            "colca-canyon-pe",
            "colca-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Costa Amalfitana",
        "count": 2,
        "slugs": [
            "amalfi-coast-it",
            "amalfi-it"
        ],
        "countrycode": [
            "IT"
        ]
    },
    {
        "label": "Dades",
        "count": 2,
        "slugs": [
            "oued-dades-ma",
            "rio-dades-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Damnoen Saduak",
        "count": 2,
        "slugs": [
            "damnoen-saduak-district-th",
            "damnoen-saduak-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Dushanbe",
        "count": 2,
        "slugs": [
            "ayni-air-base-tj",
            "dushanbe-tj"
        ],
        "countrycode": [
            "TJ"
        ]
    },
    {
        "label": "Echmiadzin",
        "count": 2,
        "slugs": [
            "echmiadzin-am",
            "vagharshapat-am"
        ],
        "countrycode": [
            "AM"
        ]
    },
    {
        "label": "El Cairo",
        "count": 2,
        "slugs": [
            "cairo-eg",
            "cairo-governorate-eg"
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "El Calafate",
        "count": 2,
        "slugs": [
            "calafate-ar",
            "el-calafate-ar"
        ],
        "countrycode": [
            "AR"
        ]
    },
    {
        "label": "Essaouira",
        "count": 2,
        "slugs": [
            "esauira-ma",
            "essaouira-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Fez",
        "count": 4,
        "slugs": [
            "fes-al-bali",
            "fes-ma",
            "fes-medina",
            "fez-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Florencia",
        "count": 2,
        "slugs": [
            "florence-it",
            "metropolitan-city-of-florence-it"
        ],
        "countrycode": [
            "IT"
        ]
    },
    {
        "label": "Gargantas del Todra",
        "count": 2,
        "slugs": [
            "gorges-du-todgha-ma",
            "todrha-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Ha Long",
        "count": 4,
        "slugs": [
            "ha-long-bay-vn",
            "ha-long-vn",
            "halong-rd-vn",
            "tp-ha-long-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hanói",
        "count": 3,
        "slugs": [
            "hanoi-vn",
            "nha-hat-lon-ha-noi-vn",
            "west-lake-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Heidelberg",
        "count": 2,
        "slugs": [
            "heidelberg-de",
            "heidelberg-za"
        ],
        "countrycode": [
            "DE",
            "ZA"
        ]
    },
    {
        "label": "Hiroshima",
        "count": 2,
        "slugs": [
            "hiroshima-jp",
            "hiroshima-prefecture-jp"
        ],
        "countrycode": [
            "JP"
        ]
    },
    {
        "label": "Ho Chi Minh",
        "count": 3,
        "slugs": [
            "cao-dai-giao-ly-vien-vn",
            "ho-chi-minh-city-vn",
            "ho-chi-minh-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hoa Lu",
        "count": 2,
        "slugs": [
            "hoa-lu-district-vn",
            "hoa-lu-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hoi An",
        "count": 2,
        "slugs": [
            "hoi-an-vn",
            "tp-hoi-an-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hue",
        "count": 3,
        "slugs": [
            "hue-vn",
            "thua-thien-hue-vn",
            "tp-hue-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Hunedoara",
        "count": 2,
        "slugs": [
            "corvin-castle-ro",
            "hunedoara-ro"
        ],
        "countrycode": [
            "RO"
        ]
    },
    {
        "label": "Ifrane",
        "count": 2,
        "slugs": [
            "ifran-ma",
            "ifrane-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Inhambane",
        "count": 2,
        "slugs": [
            "inhambane-airport-mz",
            "inhambane-mz"
        ],
        "countrycode": [
            "MZ"
        ]
    },
    {
        "label": "Kerak",
        "count": 2,
        "slugs": [
            "al-karak-jo",
            "karak-jo"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Kingston",
        "count": 2,
        "slugs": [
            "kingston-ca",
            "kingston-jm"
        ],
        "countrycode": [
            "CA",
            "JM"
        ]
    },
    {
        "label": "La Paz",
        "count": 4,
        "slugs": [
            "la-paz-cr",
            "la-paz-dept-bo",
            "la-paz-mx",
            "nuestra-senora-de-la-paz-bo"
        ],
        "countrycode": [
            "CR",
            "BO",
            "MX"
        ]
    },
    {
        "label": "Lao Cai",
        "count": 3,
        "slugs": [
            "lao-cai-vn",
            "lao-chai-vn",
            "tp-lao-cai-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Luang Prabang",
        "count": 2,
        "slugs": [
            "louangphabang-la",
            "luang-prabang-la"
        ],
        "countrycode": [
            "LA"
        ]
    },
    {
        "label": "Luxor",
        "count": 2,
        "slugs": [
            "luxor-eg",
            "luxor-governorate-eg"
        ],
        "countrycode": [
            "EG"
        ]
    },
    {
        "label": "Machu Picchu",
        "count": 3,
        "slugs": [
            "machu-picchu-pe",
            "machu-picchu-station-pe",
            "machu-pichu-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Mae Hong Son",
        "count": 2,
        "slugs": [
            "mae-hong-son-airport-th",
            "mae-hong-son-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Mai Chau",
        "count": 2,
        "slugs": [
            "mai-chau-district-vn",
            "tt-mai-chau-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Malé",
        "count": 2,
        "slugs": [
            "ibrahim-nasir-international-airport-mv",
            "male-mv"
        ],
        "countrycode": [
            "MV"
        ]
    },
    {
        "label": "Mandalay",
        "count": 2,
        "slugs": [
            "mandalay-mm",
            "mandalay-region-mm"
        ],
        "countrycode": [
            "MM"
        ]
    },
    {
        "label": "Mar Muerto",
        "count": 2,
        "slugs": [
            "dead-sea",
            "dead-sea-jo"
        ],
        "countrycode": [
            "",
            "JO"
        ]
    },
    {
        "label": "Marrakesh",
        "count": 4,
        "slugs": [
            "marrakech-ma",
            "marrakesh-ma",
            "marrakesh-tensift-el-haouz-ma",
            "medina"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Mil Islas",
        "count": 2,
        "slugs": [
            "thousand-island-lake-us",
            "thousand-islands"
        ],
        "countrycode": [
            "US",
            ""
        ]
    },
    {
        "label": "Monasterio de Rila",
        "count": 2,
        "slugs": [
            "rila-monastery-bg",
            "rilski-manastir-bg"
        ],
        "countrycode": [
            "BG"
        ]
    },
    {
        "label": "Monte Nebo",
        "count": 2,
        "slugs": [
            "mount-nebo-jo",
            "mt-nebo-jo"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Monte Verde",
        "count": 2,
        "slugs": [
            "monte-verde-cr",
            "monteverde-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "My Son",
        "count": 2,
        "slugs": [
            "my-son-jungle-temples-and-sanctuary-vn",
            "my-son-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Nha Trang",
        "count": 2,
        "slugs": [
            "nha-trang-bay-vn",
            "nha-trang-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Noravank",
        "count": 3,
        "slugs": [
            "noravan-am",
            "noravank-monastery-am",
            "noravank-monastery-road-am"
        ],
        "countrycode": [
            "AM"
        ]
    },
    {
        "label": "Olimpia",
        "count": 2,
        "slugs": [
            "archea-olimpia-gr",
            "oplimpias-gr"
        ],
        "countrycode": [
            "GR"
        ]
    },
    {
        "label": "Orachha",
        "count": 2,
        "slugs": [
            "orachha-in",
            "orchha-in"
        ],
        "countrycode": [
            "IN"
        ]
    },
    {
        "label": "Osaka",
        "count": 2,
        "slugs": [
            "osaka-jp",
            "shin-osaka-station-jp"
        ],
        "countrycode": [
            "JP"
        ]
    },
    {
        "label": "Ouagadougou",
        "count": 2,
        "slugs": [
            "ouagadougou-airport-bf",
            "ouagadougou-bf"
        ],
        "countrycode": [
            "BF"
        ]
    },
    {
        "label": "Ouarzazate",
        "count": 3,
        "slugs": [
            "ouarzazate-ma",
            "ouarzazate-province",
            "uarzazate-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Parque Nacional Manuel Antonio",
        "count": 2,
        "slugs": [
            "manuel-antonio-cr",
            "parque-nacional-manuel-antonio-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional Ngorongoro",
        "count": 2,
        "slugs": [
            "ngorongoro-conservation-area-tz",
            "ngorongoro-crater-tz"
        ],
        "countrycode": [
            "TZ"
        ]
    },
    {
        "label": "Parque Nacional Rincon de la Vieja",
        "count": 3,
        "slugs": [
            "rincon-de-la-vieja-cr",
            "rincon-de-la-vieja-national-park-cr",
            "volcan-rincon-de-la-vieja-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional Tortuguero",
        "count": 2,
        "slugs": [
            "parque-nacional-tortuguero-cr",
            "tortuguero-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional Volcán Poás",
        "count": 2,
        "slugs": [
            "poas-volcano-cr",
            "poas-volcano-national-park-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Parque Nacional de Jasper",
        "count": 2,
        "slugs": [
            "jasper-ca",
            "jasper-national-park-ca"
        ],
        "countrycode": [
            "CA"
        ]
    },
    {
        "label": "Parque Nacional de los Lagos de Plitvice",
        "count": 2,
        "slugs": [
            "plitvice-lakes-national-park-hr",
            "plitvicka-jezera-hr"
        ],
        "countrycode": [
            "HR"
        ]
    },
    {
        "label": "Petra",
        "count": 4,
        "slugs": [
            "maan-governorate-jo",
            "maan-jo",
            "petra-main-parking-lot-jo",
            "wadi-musa"
        ],
        "countrycode": [
            "JO"
        ]
    },
    {
        "label": "Phnom Penh",
        "count": 2,
        "slugs": [
            "phnom-penh-international-airport-kh",
            "phnom-penh-kh"
        ],
        "countrycode": [
            "KH"
        ]
    },
    {
        "label": "Playa de Jaco",
        "count": 3,
        "slugs": [
            "jaco-beach-cr",
            "jaco-cr",
            "playa-jaco-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Quebec",
        "count": 2,
        "slugs": [
            "quebec-ca",
            "quebec-city-ca"
        ],
        "countrycode": [
            "CA"
        ]
    },
    {
        "label": "Rabat",
        "count": 2,
        "slugs": [
            "rabat-ma",
            "rabat-ville"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Rio de Janeiro",
        "count": 2,
        "slugs": [
            "rio-de-janeiro-br",
            "state-of-rio-de-janeiro-br"
        ],
        "countrycode": [
            "BR"
        ]
    },
    {
        "label": "Roma",
        "count": 2,
        "slugs": [
            "metropolitan-city-of-rome-it",
            "rome-it"
        ],
        "countrycode": [
            "IT"
        ]
    },
    {
        "label": "Saint Louis",
        "count": 2,
        "slugs": [
            "saint-louis-sn",
            "st-louis-sn"
        ],
        "countrycode": [
            "SN"
        ]
    },
    {
        "label": "San Pedro",
        "count": 2,
        "slugs": [
            "san-pedro-bz",
            "san-pedro-cl"
        ],
        "countrycode": [
            "BZ",
            "CL"
        ]
    },
    {
        "label": "Sapa",
        "count": 3,
        "slugs": [
            "sa-pa-vn",
            "sapa-train-vn",
            "tt-sa-pa-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Sevan",
        "count": 3,
        "slugs": [
            "lago-sevan-am",
            "sevan-am",
            "sevan-lake-am"
        ],
        "countrycode": [
            "AM"
        ]
    },
    {
        "label": "Siem Reap",
        "count": 2,
        "slugs": [
            "krong-siem-reap-kh",
            "siem-reap-kh"
        ],
        "countrycode": [
            "KH"
        ]
    },
    {
        "label": "Sighișoara",
        "count": 2,
        "slugs": [
            "sighisoara-fortress-ro",
            "sighisoara-ro"
        ],
        "countrycode": [
            "RO"
        ]
    },
    {
        "label": "Sukhothai",
        "count": 2,
        "slugs": [
            "sukhothai-historical-park-th",
            "sukhothai-th"
        ],
        "countrycode": [
            "TH"
        ]
    },
    {
        "label": "Tel Aviv",
        "count": 2,
        "slugs": [
            "tel-aviv-district-il",
            "tel-aviv-yafo-il"
        ],
        "countrycode": [
            "IL"
        ]
    },
    {
        "label": "Telouet",
        "count": 2,
        "slugs": [
            "telouet-kasbah-ma",
            "telouet-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Tetúan",
        "count": 2,
        "slugs": [
            "tetouan-ma",
            "tetuan-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Trakai",
        "count": 2,
        "slugs": [
            "trakai-island-castle-lt",
            "trakai-lt"
        ],
        "countrycode": [
            "LT"
        ]
    },
    {
        "label": "Tuy Hoa",
        "count": 2,
        "slugs": [
            "tp-tuy-hoa-vn",
            "tuy-hoa-vn"
        ],
        "countrycode": [
            "VN"
        ]
    },
    {
        "label": "Tánger",
        "count": 2,
        "slugs": [
            "tanger-ma",
            "tangier-ma"
        ],
        "countrycode": [
            "MA"
        ]
    },
    {
        "label": "Urubamba",
        "count": 2,
        "slugs": [
            "urubamba-pe",
            "urubamba-province-pe"
        ],
        "countrycode": [
            "PE"
        ]
    },
    {
        "label": "Vlorë",
        "count": 2,
        "slugs": [
            "vlora-al",
            "vlore-al"
        ],
        "countrycode": [
            "AL"
        ]
    },
    {
        "label": "Volcán Arenal",
        "count": 4,
        "slugs": [
            "arenal-volcano-cr",
            "arenal-volcano-national-park-cr",
            "lake-arenal-cr",
            "volcan-arenal-cr"
        ],
        "countrycode": [
            "CR"
        ]
    },
    {
        "label": "Éfeso",
        "count": 2,
        "slugs": [
            "efes-harabeleri-tr",
            "efesou-gr"
        ],
        "countrycode": [
            "TR",
            "GR"
        ]
    }
];


module.exports = function (options, callback, errorcallback) {
    var core = options.core;
    var started = new Date();
    console.log('Scheduled task started at ' + started);
    var common = require('yourttoo.common');
    var _ = require('underscore');
    var cev = common.eventtrigger.eventcarrier(common.utils.getToken());
    var codes = [];

    var totals = {
        pending: 0,
        cursor: 0,
        total: 0
    }
   
    var zonesCollection = 'DestinationCountriesZones';
    var countriesCollection = 'DestinationCountries';
    var citiesCollection = 'DestinationCities';
    var productCollection = 'DMCProducts';
    
    var slugsIds = {};
    var slugsMatches = {};
    var slugsOK = {};

    cev.on('product.process', function (dmcproduct) {
        totals.cursor++;
        if (dmcproduct != null) {
            //console.log(dmcproduct.sleepcountry);
            
            //SLEEP
            var SLEEPprev = dmcproduct.sleepcity;
            var SLEEPvalidIds = [];
            
            _.each(dmcproduct.sleepcity, function (iid) {
                var ctid = iid.toString();
                console.log('in product check...' + ctid);
                console.log(slugsIds[ctid]);
                if (slugsIds[ctid] != null && slugsIds[ctid] != '') {
                    var valid = slugsIds[ctid];
                    SLEEPvalidIds.push(valid);
                    console.log('Id changing from ' + ctid + ' -> ' + valid);
                    _.each(dmcproduct.itinerary, function (day) {
                        if (day != null && day.sleepcity != null && day.sleepcity.cityid == ctid) {
                            console.log('Id changing for itinerary day(sleep) ' + ctid + ' -> ' + valid);
                            console.log('Slug changing for itinerary day(sleep) ' + day.sleepcity.slug + ' -> ' + slugsOK[ctid]);
                            day.sleepcity.cityid = valid;
                            day.sleepcity.slug = slugsOK[ctid];
                        }
                    });
                } else { 
                    SLEEPvalidIds.push(ctid);
                }
            });
            
            dmcproduct.sleepcity = _.uniq(SLEEPvalidIds);
            var SLEEPpost = dmcproduct.sleepcity;
            

            //STOP
            var STOPprev = dmcproduct.stopcities;
            var STOPvalidIds = [];
            
            _.each(dmcproduct.stopcities, function (iid) {
                var ctid = iid.toString();
                console.log('in product check...' + ctid);
                console.log(slugsIds[ctid]);
                if (slugsIds[ctid] != null && slugsIds[ctid] != '') {
                    var valid = slugsIds[ctid];
                    STOPvalidIds.push(valid);
                    console.log('Id changing from ' + ctid + ' -> ' + valid);
                    _.each(dmcproduct.itinerary, function (day) {
                        if (day != null && day.sleepcity != null && day.sleepcity.cityid == ctid) {
                            _.each(day.stopcities, function (stcity) { 
                                console.log('Id changing for itinerary day(stop) ' + ctid + ' -> ' + valid);
                                console.log('Slug changing for itinerary day(stop) ' + stcity.slug + ' -> ' + slugsOK[ctid]);
                                stcity.cityid = valid;
                                stcity.slug = slugsOK[ctid];
                            });
                        }
                    });
                } else {
                    STOPvalidIds.push(ctid);
                }
            });
            
            dmcproduct.stopcities = _.uniq(STOPvalidIds);
            var STOPpost = dmcproduct.stopcities;
            
            //DEPARTURE
            var DEPARTUREprev = dmcproduct.departurecity;
            var DEPARTUREvalidIds = [];
            
            _.each(dmcproduct.departurecity, function (iid) {
                var ctid = iid.toString();
                console.log('in product check...' + ctid);
                console.log(slugsIds[ctid]);
                if (slugsIds[ctid] != null && slugsIds[ctid] != '') {
                    var valid = slugsIds[ctid];
                    DEPARTUREvalidIds.push(valid);
                    console.log('Id changing from ' + ctid + ' -> ' + valid);
                    _.each(dmcproduct.itinerary, function (day) {
                        if (day != null && day.departurecity != null && day.departurecity.cityid == ctid) {
                            console.log('Id changing for itinerary day(departure) ' + ctid + ' -> ' + valid);
                            console.log('Slug changing for itinerary day(departure) ' + day.departurecity.slug + ' -> ' + slugsOK[ctid]);
                            day.departurecity.cityid = valid;
                            day.departurecity.slug = slugsOK[ctid];
                        }
                    });
                } else {
                    DEPARTUREvalidIds.push(ctid);
                }
            });
            
            dmcproduct.departurecity = _.uniq(DEPARTUREvalidIds);
            var DEPARTUREpost = dmcproduct.departurecity;


            if ((JSON.stringify(DEPARTUREpost) != JSON.stringify(DEPARTUREprev))|| 
                (JSON.stringify(STOPpost) != JSON.stringify(STOPprev)) ||
                (JSON.stringify(SLEEPpost) != JSON.stringify(SLEEPprev)) ) {
                console.log('conflicts on ' + dmcproduct.code);
                console.log(DEPARTUREprev);
                console.log(DEPARTUREpost);
                console.log(STOPprev);
                console.log(STOPpost);
                console.log(SLEEPprev);
                console.log(SLEEPpost);
                dmcproduct.save(function (err, doc) { 
                    err != null ? console.log(err): console.log(doc.code + ' saved without conflicts');
                    cev.emit('product.next');
                });
            } else {
                cev.emit('product.next');
            }
            
        }
    });

    cev.on('product.do', function (code) { 
        core.list(productCollection).model.find({ code: code })
        .exec(function (err, products) {
            err != null ? console.log(err) : console.log('lets process product ' + code);
            err != null ? cev.emit('product.next') : cev.emit('product.process', products[0]);
        });
    });

    cev.on('product.next', function () {
        if (codes != null && codes.length > 0) {
            var code = codes.shift();
            
            console.log('processing ' + totals.cursor + '/' + totals.total);
            console.log('pending ' + totals.pending);
            
            (code != null && code != undefined && code != '') ? cev.emit('product.do', code) : cev.emit('product.next');
        }
        else { 
            cev.emit('finish.done');
        }
    });

    cev.on('product.get', function (products) { 
        console.log('products got...');
        console.log(products.length);

        totals.pending = products.length;
        totals.total = products.length;
        if (products != null && products.length > 0) {
            codes = _.map(products, function (product) { return product.code });
            
            cev.emit('product.next');
        } else {
            console.log('no product cities conflicts...');
            cev.emit('finish.done');
        }
    });
    
    cev.on('city.get', function (cities) {
        var cityids = [];
        
        cityids = _.map(cities, function (city) {
            return city._id.toString();
        });
        
        var idBads = [];

        for (var prop in slugsMatches) {
            var slugRE = prop;
            var slugOK = slugsMatches[prop];
            console.log('checking..' + prop);
            
            var repcities = _.filter(cities, function (city) { return city.slug == prop });
            var norepcities = _.filter(cities, function (city) { return city.slug == slugsMatches[prop]; });

            if (repcities != null && repcities.length > 0) {
                var candidate = repcities[0];
                var match = norepcities[0];
                var idbad = candidate._id.toString();
                var idok = match._id.toString();
                var slugok = match.slug;
                if (idbad != idok) {
                    if (idBads.indexOf(idbad) < 0) {
                        idBads.push(idbad);
                    }
                }

                slugsIds[idbad] = idok;
                slugsOK[idbad] = slugok;
            } else { 
                console.log('no matches...');
            }
        }
        
        console.log(slugsIds);
        console.log(slugsOK);
        //console.log(slugsIds['5699090e52c4bf98051d9cb4']);
        console.log(idBads);

        core.list(productCollection).model.find({
            $or: [
                { sleepcity : { $in : idBads } }] 
                //{ departurecity : { $in : idBads } },
                //{ stopcities : { $in : idBads } }]
        })
        .select({ code : 1 })
        .sort({ code: 1 })
        .exec(function (err, products) {
            (err != null) ? cev.emit('finish.error', err) : cev.emit('product.get', products);
        });

        console.log('launched');
    });

    cev.on('finish.error', function (err) {
        console.log(err);
        errorcallback(err);
    });

    cev.on('finish.done', function (results) {
        callback(results);
    });

    var arrslugs = _.map(repeated, function (rep) {
        return rep.slugs;
    });
    
    _.each(repeated, function (rep) {
        var dt = _.filter(detected, function (d) { return d.label == rep.label; });
        if (dt != null && dt.length > 0) {
            var dtcted = dt[0];
            _.each(rep.slugs, function (slug) { 
                slugsMatches[slug] = dtcted.slugs[0];
            });
        }
    });
    
    console.log(slugsMatches);

    var slugs = [];
    _.each(arrslugs, function (slgs) {
        _.each(slgs, function (slug) {
            if (slugs.indexOf(slug) < 0) { 
                slugs.push(slug);
            } 
        });
    });
    

    //find all cities
    core.list(citiesCollection).model.find({ slug : { $in: slugs }}).exec(function (err, cities) {
        (err != null) ? cev.emit('finish.error', err) : cev.emit('city.get', cities);
    });
}